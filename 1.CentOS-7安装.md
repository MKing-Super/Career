# 虚拟机

## 一、Oracle VM VirtualBox

VirtualBox-6.1.26-145957-Win.exe

CentOS-7-x86_64-DVD-2207-02.iso

Centos-7.repo

> 右Ctrl 鼠标出来

### 1 新建

1.1 新建虚拟电脑

```
名称：Red Hat02
文件夹：D:\Users\kun.ma\VirtualBox VMs
类型：Linux
版本：Red Hat（64-bit）
```

1.2 内存（默认）

1.3 虚拟硬盘（默认）

1.4 虚拟硬盘文件类型（默认）

1.5 存储在物理硬盘上（默认）

1.6 文件位置和大小（默认）

### 2 设置

2.1 存储 - 控制器：IDE - 没有盘片 - 分配光驱 - 选择虚拟盘 - 选择“CentOS-7-x86_64-DVD-2207-02.iso” - ok

2.2 网络 - 连接方式 “桥接网卡”

### 3 启动

3.1 install CentOS 7

### 4 GUI页面

4.1 English - Continue

4.2 INSTALLATION DESTINATION - 点击 - done - Begin Installation

4.3 ROOT PASSWORD - 点击 - 设置密码 - done

4.4 Reboot

### 5 开启CentOS7

5.1 联网

```
ping -c 3 baidu.com
ip addr
```

> 如果没有网络，输出结果可能是下图这样的，继续往下看，查看解决方法
>
> ```
> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
> ```

运行以下命令重启 enp0s3 网卡，就可以正常访问网络并且能看到局域网 IP 地址了

```
ifup enp0s3
```

现在虽然解决了没有网络的问题，但是重启系统后可以发现又没有网络了

其实开机没有网络的本质原因是因为安装操作系统时，没有设置打开【以太网连接】

如果忘记设置打开【以太网连接】，我们只需要手动设置 enp0s3 网卡开机自启

```
vi /etc/sysconfig/network-scripts/ifcfg-enp0s3
```

将文件内容中的 `ONBOOT=no` 改为 `ONBOOT=yes`

5.2 换源

备份CentOS-Base.repo文件

```
[root@localhost home]# cp /home/CentOS-7.repo /etc/yum.repos.d/CentOS-7.repo
[root@localhost yum.repos.d]# cd /etc/yum.repos.d/
[root@localhost yum.repos.d]# mv CentOS-Base.repo CentOS-Base.repo.bak
```

将 Centos-7.repo 放到 /etc/yum.repos.d/ 中

```
[root@localhost yum.repos.d]# mv CentOS-7.repo CentOS-Base.repo
```

清理和生成新缓存

```
[root@localhost yum.repos.d]# yum clean all 
[root@localhost yum.repos.d]# yum makecache 
```

检查是否已使用新的源

```
yum repolist
```



### 6 静态IP（选）

查看当前网卡名称

```
ip addr
```

编辑网卡配置文件

```
[root@192 ~]# cd /etc/sysconfig/network-scripts/

[root@192 network-scripts]# mv ifcfg-enp0s3 ifcfg-enp0s3.bak

[root@192 network-scripts]# vi /etc/sysconfig/network-scripts/ifcfg-enp0s3
```

修改或添加以下内容

```
TYPE=Ethernet
BOOTPROTO=static        # 改为 static 或 none
DEFROUTE=yes
NAME=enp0s3			   # 根据文件名
DEVICE=enp0s3		   # 根据文件名
ONBOOT=yes             # 开机自动启用

# 固定 IP 配置
IPADDR=192.168.1.100   # 设置的固定 IP
NETMASK=255.255.255.0  # 子网掩码
GATEWAY=192.168.1.1    # 网关
DNS1=8.8.8.8           # 首选 DNS
DNS2=8.8.4.4           # 备用 DNS
```

重启网络服务

```
systemctl restart network
ip addr show ens33
```

