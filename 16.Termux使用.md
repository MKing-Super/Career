# Termux使用

**putty连接方式：IP + 8022**

```bash
# IP
ifconfig

# 设置密码
passwd
```

**FileZilla Client传输文件配置：**

文件 -> 站点管理器 -> 新站点 -> 协议：SFTP - SSH File Transfer Protocol -> 主机：IP -> 端口：8022 -> 登录类型：正常 -> 用户：root -> 密码：{你的密码}

**伸长SSH秘钥**

```bash
pkg install openssh
ssh-keygen -t rsa -b 4096 -C "makun5201@163.com"
cat ~/.ssh/id_rsa.pub
ls -a
```



## 一、常用命令

```bash
# putty粘贴
按 Shift + Insert 粘贴。

# 监听 8080 端口（可自定义），可在页面上查看手机存储数据
python -m http.server 8080 --bind 0.0.0.0
```



## 二、包准备

```bash
# 安装 OpenSSH
pkg install openssh
# sshd

# 在 Termux 中转换换行符
pkg install dos2unix
# dos2unix script.sh

# 安装 Vim
pkg install vim
# 设置行号
vim ~/.vimrc
# 在文件中添加以下内容：
set number


# 安装 Git
pkg install git
# git --version

# 安装 OpenJDK17
pkg install openjdk-17
# java -version

# 安装 which
pkg install which
# which java

# 安装 Maven
pkg install maven
# mvn -version
# which mvn

# 模拟 Root（仅限当前会话，非真实 Root）
pkg install proot
proot -0 bash
# whoami

# 安装 wget
pkg install wget
# wget --version

# 安装 iptables
pkg install iptables
# iptables --version

# 安装 ngrok（使用 ngrok 内网穿透）
# pkg install ngrok
# 没有root权限无法安装

# 安装 socat（使用 socat 端口转发）
# pkg install socat
# 使用命令异常
# socat tcp-listen:9000,fork tcp:localhost:9000 &
# ps aux | grep socat
# pkill -f "socat tcp-listen:9000"

# 安装 iproute2
pkg install iproute2
# 没有root权限无法使用
# ~ $ ip
# Cannot bind netlink socket: Permission denied

# 安装 python
pkg install python
# python

# 安装 curl
pkg install curl
# curl --version

# 安装字体和字体配置
pkg install fontconfig -y
pkg install fontconfig-utils -y
pkg install ttf-dejavu -y

# 安转bash已执行sh脚本
pkg install bash

# 安装 jq。jq 是一个轻量级且灵活的命令行 JSON 处理器。
pkg install jq
```



## 三、换源

系统

```bash
vi $PREFIX/etc/apt/sources.list


# 清华大学 TUNA 镜像
deb https://mirrors.tuna.tsinghua.edu.cn/termux/termux-packages-24 stable main


pkg update
```

maven

```bash
vi $PREFIX/opt/maven/conf/settings.xml


<mirror>
  <id>aliyun</id>
  <name>Aliyun Maven Mirror</name>
  <url>https://maven.aliyun.com/repository/public</url>
  <mirrorOf>central</mirrorOf>
</mirror>

```



## 四、外部访问

springboot项目

```bash
# 增加 server.address=0.0.0.0 配置
java -jar work-admin-1.0.0-SNAPSHOT.jar --server.port="9002" --spring.application.name="work-admin" --eureka.client.service-url.defaultZone="http://10.50.10.113:9100/eureka/" --server.address=0.0.0.0
```

> 杀死进程：
>
> ```bash
> ~ $ ps aux | grep work-admin
> u0_a385  14264 20.1  1.6 17414780 258788 pts/1 S<l+  1970   0:23 java -jar work-admin-1.0.0-SNAPSHOT.jar --server.port=9002 --spring.application.name=work-admin --eureka.client.service-url.defaultZone=http://10.50.10.113:9100/eureka/ --server.address=0.0.0.0
> u0_a385  14607  2.0  0.0 10790000 3936 pts/2   S<+   1970   0:00 grep work-admin
> 
> ~ $ kill 14264
> ```





## 五、文件下载地址

### 1 人人视频

phone：手动移动

```
cd /storage/emulated/0/Android/data/com.example.pptv/files/PPTV/Download
```

文件转换脚本

1_tranfer_script.sh

```bash
#!/bin/bash

# 放在 Completed 文件夹中
# 192.168.137.251       8022
# bash tranfer_script.sh 'Dr. House S01'
# bash temp 'Dr. House S01'

# param
movie_name="$1"

# 根据情况修正文件夹位置！！！！！！
MOVIES_ABS_PATH="/data/data/com.termux/files/home/storage/shared/Download/Movies_temp/Completed"

if [ -z "$movie_name"]; then
  echo "参数错误"
  exit 1
fi

echo "rename start >>>>>>>>>>>"
cd "$MOVIES_ABS_PATH/$movie_name"
echo "$(pwd)"
# echo "$(ls)"

# 遍历当前目录下的所有文件夹
for dir in */; do
  # 移除末尾的斜杠
  dir_name="${dir%/}"

  # 提取点号后的数字
  if [[ "$dir_name" =~ \.([0-9]+)$ ]]; then
    new_name="${BASH_REMATCH[1]}"

        # 补零
    if [ ${#new_name} -eq 1 ]; then
        new_name="0${new_name}"
    elif [ ${#new_name} -eq 2 ]; then
        new_name="$new_name"
    else
        # 如果超过两位数，保持原样
        new_name="$new_name"
    fi
        new_name="${movie_name}E${new_name}"


    # 检查新名称是否已存在
    if [ -d "$new_name" ]; then
        echo "  警告: '$new_name' 已存在，跳过"
    else
          echo "重命名: '$dir_name' -> '$new_name'"
      mv "$dir_name" "$new_name"
    fi
  else
      echo "跳过: '$dir_name' (不匹配模式)"
  fi
done
echo "rename end <<<<<<<<<<"


echo ""
echo ""
echo "============================================================"
echo "遍历当前目录下的所有文件夹（处理 MP4、vtt 文件） start >>>>>>>>>"
for dir1 in */; do
  # 移除末尾的斜杠
  dir_name1="${dir1%/}"
  echo "${dir_name1} ------->"
  cd "$MOVIES_ABS_PATH/$movie_name/$dir_name1"
  echo "$(pwd)"

  # 遍历当前目录下的所有文件
  for file in *; do
    if [ -f "$file" ]; then

      if [[ "$file" == *.mp4* ]]; then
        echo "重命名: $file -> ${dir_name1}.mp4"
                mv "${file}" "${dir_name1}.mp4"
      fi
          if [[ "$file" == *中文* ]]; then
          echo "重命名: $file -> ${dir_name1}(Chinese).vtt"
                  mv "${file}" "${dir_name1}(Chinese).vtt"
      fi
          if [[ "$file" == *外文* ]]; then
          echo "重命名: $file -> ${dir_name1}(Enghlish).vtt"
                  mv "${file}" "${dir_name1}(Enghlish).vtt"
      fi
          if [[ "$file" == *双语* ]]; then
          echo "重命名: $file -> ${dir_name1}(both).vtt"
                  mv "${file}" "${dir_name1}(both).vtt"
      fi
    fi
  done

  echo "${dir_name1} <--------------------------"
  cd ..
done
echo "遍历当前目录下的所有文件夹（处理 MP4、vtt 文件） end <<<<<<<<<<<"


echo ""
echo ""
echo "============================================================"
echo "遍历当前目录下的所有文件夹（处理 m3u8 文件） start >>>>>>>>>>>>>>>"
for dir1 in */; do
  # 移除末尾的斜杠
  dir_name1="${dir1%/}"

  cd "$MOVIES_ABS_PATH/$movie_name/$dir_name1"
  # echo "$(pwd)"

  # 遍历当前目录下的所有文件
  for file in *; do
    if [ -f "$file" ]; then
          if [[ "$file" == *.m3u8* ]]; then
            echo "${dir_name1} ------->"
        echo "找到: $file"
                echo "++++++"
                echo "文件夹对应名称：.${file}_0"
                echo "重命名: $file -> ${dir_name1}.m3u8"
                echo "重命名: .${file}_0 -> ${dir_name1}"
                mv "${file}" "${dir_name1}.m3u8"
                mv ".${file}_0" "${dir_name1}"

                season_folder="./${dir_name1}"
                sed "s|.*/|${season_folder}/|" "${dir_name1}.m3u8" > "${dir_name1}.m3u8_bak"
                mv "${dir_name1}.m3u8" "${dir_name1}.m3u8_0"
                mv "${dir_name1}.m3u8_bak" "${dir_name1}.m3u8"

                echo "${dir_name1} <--------------------------"
      fi

    fi
  done

  cd ..
done
echo "遍历当前目录下的所有文件夹（处理 m3u8 文件） end <<<<<<<<<<<<<<<<<<<"







# 使用方法示例：
# 复制
# cp -r "/data/data/com.termux/files/home/storage/shared/Download/Movies_temp/.Waiting/Dr. House S01" "/data/data/com.termux/files/home/storage/shared/Download/Movies_temp/Completed/Dr. House S01"
# 执行
# bash tranfer_script.sh 'Dr. House S01'


```

2_mv_files.sh

```bash
#!/bin/bash

# 放在 Completed 文件夹中
# 192.168.137.251       8022
# bash 2_mv_files.sh 'Dr. House S01'

# param
movie_name="$1"

# 根据情况修正文件夹位置！！！！！！
MOVIES_ABS_PATH="/data/data/com.termux/files/home/storage/shared/Download/Movies_temp/Completed"

if [ -z "$movie_name"]; then
  echo "参数错误"
  exit 1
fi

VTT_PATH="vtt"
cd "$MOVIES_ABS_PATH/$movie_name"
mkdir -p "${VTT_PATH}"

echo ""
echo ""
echo "============================================================"
echo "遍历当前目录下的所有文件夹（处理 MP4、vtt 文件） start >>>>>>>>>"
for dir1 in */; do
  # 移除末尾的斜杠
  dir_name1="${dir1%/}"
  echo "${dir_name1} ------->"
  if [[ "${dir_name1}" == "${VTT_PATH}" ]]; then
    echo "文件夹 ${dir_name1} 跳过"
        echo "${dir_name1} <--------------------------"
  else

    cd "$MOVIES_ABS_PATH/$movie_name/$dir_name1"
    echo "$(pwd)"
    # 遍历当前目录下的所有文件
    for file in *; do
      if [ -f "$file" ]; then

        if [[ "$file" == *.mp4* ]]; then
          echo "移动: $file -> ../${dir_name1}.mp4"
                mv "${file}" "../${dir_name1}.mp4"
        fi
            if [[ "$file" == *Chinese* ]]; then
            echo "移动: $file -> ../vtt/${dir_name1}(Chinese).vtt"
                  mv "${file}" "../vtt/${dir_name1}(Chinese).vtt"
        fi
            if [[ "$file" == *Enghlish* ]]; then
            echo "移动: $file -> ../vtt/${dir_name1}(Enghlish).vtt"
                  mv "${file}" "../vtt/${dir_name1}(Enghlish).vtt"
        fi
            if [[ "$file" == *both* ]]; then
            echo "移动: $file -> ../vtt/${dir_name1}(both).vtt"
                  mv "${file}" "../vtt/${dir_name1}(both).vtt"
        fi
      fi
    done

    cd ..
    echo "${dir_name1} <--------------------------"

  fi

done
echo "遍历当前目录下的所有文件夹（处理 MP4、vtt 文件） end <<<<<<<<<<<"


```



## 六、连接工具

### 1 putty

```bash
# 命令行 外部复制粘贴
鼠标右键

# vim 外部复制粘贴
Shift + Insert


```

